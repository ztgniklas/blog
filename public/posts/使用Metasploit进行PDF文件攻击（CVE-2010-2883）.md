---
title: 使用Metasploit进行PDF文件攻击（CVE-2010-2883）
date: '2019-07-23 14:31:16'
tags: 
- 渗透测试
- 工具
---

> #### 0x00 CVE-2010-2883 漏洞原理
Adobe Reader在处理CoolType字体文件的sing表时，存在栈溢出漏洞，当打开特制的恶意PDF文件时，可允许任意代码远程执行。

影响版本：Adobe Reader 8.2.4 - 9.3.4
<!--more-->
> #### 0x01 实验环境
靶机：Windows 7 SP1 64位 (IP: 192.168.16.132)
攻击机：Kali Linux (IP: 192.168.16.134)
软件：Adobe Reader 9.3

> #### 0x02 实验步骤
##### 1 在Kali上，使用metasploit生成木马PDF文件
搜索模块，选择如图所示的漏洞利用模块，看到该模块只需要设置木马文件名：
![7b0c1bc7.png](7b0c1bc7.png)

加载反弹shell的程序作为payload，并设置监听地址（攻击机的IP）和端口（随意）：
![3178f6b1.png](3178f6b1.png)

之后设置木马文件名，最后生成木马PDF文件：
![4cb3d359.png](4cb3d359.png)

这样就生成了我们用来攻击的PDF，把它拷贝到靶机上。

##### 2 开启监听会话，等待靶机回弹shell
选择后门模块，依旧选择反弹shell的reverse_tcp作为payload。设置监听地址和端口同上。运行后开始监听：
![d686884b.png](d686884b.png)

##### 3 靶机使用Adobe Reader 9.3打开木马PDF文件，在Kali上弹回shell
在靶机上打开文件后，应该会卡住，这是攻击机上应该已经成功获取到shell会话了：
![5442f1ca.png](5442f1ca.png)

##### 4 快速切换到其它系统进程，保持控制
在实际利用过程中，考虑到靶机程序卡住，随时可能退出，因此要尽快将当前meterpreter会话从Adobe Reader进程移植到其它稳定存在的进程，比如explorer.exe，以实现持续控制：
![80fcf806.png](80fcf806.png)

![13bb9e70.png](13bb9e70.png)

之后就可以根据需要执行meterpreter命令了：
![b3273645.png](b3273645.png)